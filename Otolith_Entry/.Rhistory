#load libraries
library(EMAdownload)
library(tidyverse)
library(dplyr)
#check functions
ls(package:EMAdownload)
###There are two extra functions in here.  %>% and hello.  Presumably these should both be removed?
#load in data flat files
fish <- get_ema_fish()
catch <- get_ema_catch()
event <- get_ema_event()
event_parameters <- get_ema_event_parameters()
tsn <- get_ema_taxonomy()
#%>% test to ensure no functionality issues.  Seems correct
catch_filter <- catch %>%
dplyr::filter(gear=="CAN")
#test record integrity of join_event_catch full query
#convert trawl_type to list and pipe into trawl_method filter.  it buts my brain that it's called tow type in the table but
#trawl method here, but I get why.
trawl_type <- as.list(unique(event$tow_type))
catch_join <- join_event_catch(gear = c("CAN","MAR","3MBT","NETS156","Nor264"),trawl_method=trawl_type)
#remove the pre-2003 years from catch
catch$year <- as.numeric(substr(catch$station_id,1,4))
catch_manual <- catch %>%
dplyr::filter(year >= 2003)
#determine records that appear in the full manual join but not in ema download join_event_catch
catch_missing_emadownload <- anti_join(catch_join,catch_manual,by=c("station_id","event_code","gear","species_tsn","lhs_code"))
view(catch_missing_emadownload)
###tTHESE ARE TOWS THAT HAD 0 CATCH.  They are mostly beam trawls.  I thought you had decided to strip out all beam trawl data.  If so, these should be deleted from the event table.
#determine records that appear in join_event_catch but not in manual join
catch_missing_manual <- anti_join(catch_manual,catch_join,by=c("station_id","event_code","gear","species_tsn","lhs_code"))
help(anti_join())
help(anti_join)
fish_join <- join_event_fish()
fish_join <- join_event_fish()
catch <- get_ema_catch()
View(catch)
event <- get_ema_event()
View(catch)
View(event)
event <- get_ema_event() %>%
dplyr::filter(gear_performance != "u")
event <- get_ema_event()
event <- get_ema_event() %>%
dplyr::filter(gear_performance != "U")
library(EMAdownload)
library(tidyverse)
library(dplyr)
#check functions
help(join_event_catch())
help(join_event_catch)
event <- get_ema_event()
library(readxl)
library(readxl)
library(tidyverse)
library(ggplot2)
library(readxl)
library(tidyverse)
library(ggplot2)
#code line to install EMA download.  If devtools is uninstalled please use
#install.packages("devtools")
#devtools::install_github("afsc-ema/EMAdownload", quiet = F, force = T, dependencies=TRUE, build_vignettes=TRUE)
library(EMAdownload)
wd()
getwd()
library(ggplot)
library(ggplot2)
library(tidyverse)
df <- data.frame(p = seq(0,1,by=0.1))
View(df)
df <- data.frame(p = seq(0,1,by=0.01))
df$not_p <- 1-df$p
View(df)
df$var <- df$p*df$not_p
View(df)
ggplot() +
geom_point(aes(x=p,y=var))
ggplot() +
geom_point(data=df,aes(x=p,y=var))
exp(3.1+(1.79/2))
var <- (exp(3.1^2)-1)exp(2*3.1+1.79^2)
var <- (exp(3.1^2)-1)*exp(2*3.1+1.79^2)
var
exp(2*3.1+1.79^2)
help(ggsave)
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
db_path <- "C:\\Users\\andrew.dimond\\Documents\\GitHub\\SableSpecimen\\SableSpecimen_DB.accdb"
channel <- odbcConnectAccess2007(db_path)
library(RODBC)
library(ggplot2)
library(dplyr)
db_path <- "C:\\Users\\andrew.dimond\\Documents\\GitHub\\SableSpecimen\\SableSpecimen_DB.accdb"
channel <- odbcConnectAccess2007(db_path)
otolith <- sqlQuery(channel,"select * from Otolith ORDER BY Otolith_number")
figure <- ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic()
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
getwd()
ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic()
ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic() +
theme(legend.text = element_text(size=4))
setwd("~/GitHub/SableSpecimen/Otolith_Entry")
figure <- ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic() +
theme(legend.text = element_text(size=4))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
figure <- ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic() +
theme(axis.text = element_text(size=4))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
figure <- ggplot() +
geom_point(data=otolith,aes(x=Length,y=Weight)) +
geom_point(data=otolith[nrow(otolith),],aes(x=Length,y=Weight),size=2,color="Red") +
theme_classic() +
theme(axis.text = element_text(size=4),
axis.title = element_text(size=4))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
figure <- ggplot() +
geom_point(data=otolith, aes(x=Length, y=Weight)) +
geom_point(data=otolith[nrow(otolith),], aes(x=Length, y=Weight), size=2, color="Red") +
theme_classic() +
theme(axis.text = element_text(size=4),
axis.title = element_text(size=4),
plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
figure <- ggplot() +
geom_point(data=otolith, aes(x=Length, y=Weight)) +
geom_point(data=otolith[nrow(otolith),], aes(x=Length, y=Weight), size=2, color="Red") +
theme_classic() +
theme(axis.text = element_text(size=4),
axis.title = element_blank(),
plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
figure <- ggplot() +
geom_point(data=otolith, aes(x=Length, y=Weight),size=0.4) +
geom_point(data=otolith[nrow(otolith),], aes(x=Length, y=Weight), size=0.8, color="Red") +
theme_classic() +
theme(axis.text = element_text(size=4),
axis.title = element_blank(),
plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"))
ggsave(filename="lw_plot.png",plot=figure,height=280,width=360,units=c("px"))
